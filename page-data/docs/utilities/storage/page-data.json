{"componentChunkName":"component---src-pages-docs-mdx-slug-js","path":"/docs/utilities/storage","result":{"data":{"mdx":{"slug":"utilities/storage","frontmatter":{"title":"Storage","description":null},"body":"const _excluded = [\"components\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nconst _frontmatter = {\n  \"title\": \"Storage\",\n  \"nav\": 3.01,\n  \"keywords\": \"storage,localstorage,sessionstorage,asyncstorage,persist,persistence\"\n};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return mdx(\"div\", props);\n};\nconst CodeSandbox = makeShortcode(\"CodeSandbox\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  let {\n      components\n    } = _ref,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", null, \"atomWithStorage {#atomwithstorage}\"), mdx(\"p\", null, \"\\u53C2\\u8003\\uFF1A\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/pmndrs/jotai/pull/394\"\n  }, \"https://github.com/pmndrs/jotai/pull/394\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-jsx\"\n  }, \"import { useAtom } from 'jotai'\\nimport { atomWithStorage } from 'jotai/utils'\\n\\nconst darkModeAtom = atomWithStorage('darkMode', false)\\n\\nconst Page = () => {\\n  const [darkMode, setDarkMode] = useAtom(darkModeAtom)\\n\\n  return (\\n    <>\\n      <h1>Welcome to {darkMode ? 'dark' : 'light'} mode!</h1>\\n      <button onClick={() => setDarkMode(!darkMode)}>toggle theme</button>\\n    </>\\n  )\\n}\\n\")), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"atomWithStorage\"), \" \\u51FD\\u6570\\u521B\\u5EFA\\u4E86\\u4E00\\u4E2A\\u539F\\u5B50\\uFF0C\\u5176\\u503C\\u5728 React \\u7684 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"localStorage\"), \" \\u6216 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sessionStorage\"), \"\\uFF0C\\u6216\\u8005\\u5728 React Native \\u7684 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"AsyncStorage\"), \" \\u4E2D\\u6301\\u4E45\\u5316\\u3002\"), mdx(\"h3\", null, \"\\u53C2\\u6570 {#parameters}\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"key\"), \"\\uFF08\\u5FC5\\u9700\\uFF09\\uFF1A\\u5728\\u5C06\\u72B6\\u6001\\u4E0ElocalStorage\\uFF0CsessionStorage\\u6216AsyncStorage\\u540C\\u6B65\\u65F6\\u4F7F\\u7528\\u7684\\u552F\\u4E00\\u5B57\\u7B26\\u4E32\\u4F5C\\u4E3A\\u952E\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"initialValue\"), \"\\uFF08\\u5FC5\\u9700\\uFF09\\uFF1A\\u539F\\u5B50\\u7684\\u521D\\u59CB\\u503C\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"storage\"), \"\\uFF08\\u53EF\\u9009\\uFF09\\uFF1A\\u5177\\u6709\\u4EE5\\u4E0B\\u65B9\\u6CD5\\u7684\\u5BF9\\u8C61\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"getItem(key, initialValue)\"), \"\\uFF08\\u5FC5\\u9700\\uFF09\\uFF1A\\u4ECE\\u5B58\\u50A8\\u4E2D\\u8BFB\\u53D6\\u9879\\u76EE\\uFF0C\\u6216\\u56DE\\u9000\\u5230\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"initialValue\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"setItem(key, value)\"), \"\\uFF08\\u5FC5\\u9700\\uFF09\\uFF1A\\u5C06\\u9879\\u76EE\\u4FDD\\u5B58\\u5230\\u5B58\\u50A8\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"removeItem(key)\"), \"\\uFF08\\u5FC5\\u9700\\uFF09\\uFF1A\\u4ECE\\u5B58\\u50A8\\u4E2D\\u5220\\u9664\\u9879\\u76EE\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"subscribe(key, callback, initialValue)\"), \"\\uFF08\\u53EF\\u9009\\uFF09\\uFF1A\\u8BA2\\u9605\\u5916\\u90E8\\u5B58\\u50A8\\u66F4\\u65B0\\u7684\\u65B9\\u6CD5\\u3002\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"options\"), \"\\uFF08\\u53EF\\u9009\\uFF09\\uFF1A\\u5177\\u6709\\u4EE5\\u4E0B\\u5C5E\\u6027\\u7684\\u5BF9\\u8C61\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"getOnInit\"), \"\\uFF08\\u53EF\\u9009\\uFF0C\\u9ED8\\u8BA4\\u4E3A\", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"false\"), \"\\uFF09\\uFF1A\\u4E00\\u4E2A\\u5E03\\u5C14\\u503C\\uFF0C\\u8868\\u793A\\u662F\\u5426\\u5728\\u521D\\u59CB\\u5316\\u65F6\\u4ECE\\u5B58\\u50A8\\u4E2D\\u83B7\\u53D6\\u9879\\u76EE\\u3002\\u8BF7\\u6CE8\\u610F\\uFF0C\\u5728SPA\\u4E2D\\uFF0C\\u5982\\u679C\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getOnInit\"), \"\\u672A\\u8BBE\\u7F6E\\u6216\\u4E3A\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"false\"), \"\\uFF0C\\u5219\\u59CB\\u7EC8\\u4F1A\\u5728\\u521D\\u59CB\\u5316\\u65F6\\u83B7\\u53D6\\u521D\\u59CB\\u503C\\uFF0C\\u800C\\u4E0D\\u662F\\u5B58\\u50A8\\u7684\\u503C\\u3002\\u5982\\u679C\\u9996\\u9009\\u5B58\\u50A8\\u7684\\u503C\\uFF0C\\u5C06\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getOnInit\"), \"\\u8BBE\\u7F6E\\u4E3A\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"true\"), \"\\u3002\")), mdx(\"p\", null, \"\\u5982\\u679C\\u672A\\u6307\\u5B9A\\uFF0C\\u9ED8\\u8BA4\\u7684\\u5B58\\u50A8\\u5B9E\\u73B0\\u4F7F\\u7528\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"localStorage\"), \"\\u8FDB\\u884C\\u5B58\\u50A8/\\u68C0\\u7D22\\uFF0C\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"JSON.stringify()\"), \"/\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"JSON.parse()\"), \"\\u8FDB\\u884C\\u5E8F\\u5217\\u5316/\\u53CD\\u5E8F\\u5217\\u5316\\uFF0C\\u5E76\\u8BA2\\u9605\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"storage\"), \"\\u4E8B\\u4EF6\\u8FDB\\u884C\\u8DE8\\u6807\\u7B7E\\u540C\\u6B65\\u3002\"), mdx(CodeSandbox, {\n    id: \"vuwi7\",\n    mdxType: \"CodeSandbox\"\n  }), mdx(\"h3\", null, mdx(\"inlineCode\", {\n    parentName: \"h3\"\n  }, \"createJSONStorage\"), \" \\u5DE5\\u5177 {#\", mdx(\"inlineCode\", {\n    parentName: \"h3\"\n  }, \"createjsonstorage\"), \"-util}\"), mdx(\"p\", null, \"\\u4E3A\\u4E86\\u4F7F\\u7528\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"JSON.stringify()\"), \"/\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"JSON.parse()\"), \"\\u521B\\u5EFA\\u81EA\\u5B9A\\u4E49\\u5B58\\u50A8\\u5B9E\\u73B0\\uFF0C\\u63D0\\u4F9B\\u4E86\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"createJSONStorage\"), \"\\u5DE5\\u5177\\u3002\"), mdx(\"p\", null, \"\\u4F7F\\u7528\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"const storage = createJSONStorage(\\n  // getStringStorage\\n  () => localStorage, // \\u6216 sessionStorage, asyncStorage \\u6216\\u7C7B\\u4F3C\\u7684\\n  // options (\\u53EF\\u9009)\\n  {\\n    reviver, // JSON.parse \\u7684\\u53EF\\u9009 reviver \\u9009\\u9879\\n    replacer, // JSON.stringify \\u7684\\u53EF\\u9009 replacer \\u9009\\u9879\\n  },\\n)\\n\")), mdx(\"p\", null, \"\\u6CE8\\u610F\\uFF1A\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"JSON.parse\"), \" \\u4E0D\\u662F\\u7C7B\\u578B\\u5B89\\u5168\\u7684\\u3002\\u5982\\u679C\\u5B83\\u4E0D\\u80FD\\u63A5\\u53D7\\u4EFB\\u4F55\\u7C7B\\u578B\\uFF0C\\u90A3\\u4E48\\u5BF9\\u4E8E\\u751F\\u4EA7\\u5E94\\u7528\\u7A0B\\u5E8F\\uFF0C\\u67D0\\u79CD\\u9A8C\\u8BC1\\u5C06\\u662F\\u5FC5\\u8981\\u7684\\u3002\"), mdx(\"h3\", null, \"\\u670D\\u52A1\\u5668\\u7AEF\\u6E32\\u67D3 {#server-side-rendering}\"), mdx(\"p\", null, \"\\u4EFB\\u4F55\\u4F9D\\u8D56\\u4E8E\\u5B58\\u50A8\\u539F\\u5B50\\u503C\\u7684JSX\\u6807\\u8BB0\\uFF08\\u4F8B\\u5982\\uFF0C\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"className\"), \"\\u6216\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"style\"), \"\\u5C5E\\u6027\\uFF09\\u5728\\u670D\\u52A1\\u5668\\u4E0A\\u6E32\\u67D3\\u65F6\\u5C06\\u4F7F\\u7528\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"initialValue\"), \"\\uFF08\\u56E0\\u4E3A\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"localStorage\"), \"\\u548C\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sessionStorage\"), \"\\u5728\\u670D\\u52A1\\u5668\\u4E0A\\u4E0D\\u53EF\\u7528\\uFF09\\u3002\"), mdx(\"p\", null, \"\\u8FD9\\u610F\\u5473\\u7740\\uFF0C\\u5982\\u679C\\u7528\\u6237\\u6709\\u4E00\\u4E2A\\u4E0E\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"initialValue\"), \"\\u4E0D\\u540C\\u7684\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"storedValue\"), \"\\uFF0C\\u90A3\\u4E48\\u6700\\u521D\\u63D0\\u4F9B\\u7ED9\\u7528\\u6237\\u6D4F\\u89C8\\u5668\\u7684HTML\\u548CReact\\u5728\\u91CD\\u65B0\\u6C34\\u5408\\u8FC7\\u7A0B\\u4E2D\\u671F\\u671B\\u7684\\u5185\\u5BB9\\u4E4B\\u95F4\\u5C06\\u5B58\\u5728\\u4E0D\\u5339\\u914D\\u3002\"), mdx(\"p\", null, \"\\u5BF9\\u6B64\\u95EE\\u9898\\u7684\\u5EFA\\u8BAE\\u89E3\\u51B3\\u65B9\\u6848\\u662F\\u53EA\\u5728\\u5BA2\\u6237\\u7AEF\\u6E32\\u67D3\\u4F9D\\u8D56\\u4E8E\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"storedValue\"), \"\\u7684\\u5185\\u5BB9\\uFF0C\\u901A\\u8FC7\\u5C06\\u5176\\u5305\\u88C5\\u5728\\u4E00\\u4E2A\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.joshwcomeau.com/react/the-perils-of-rehydration/#abstractions\"\n  }, \"\\u81EA\\u5B9A\\u4E49\\u7684\", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"<ClientOnly>\"), \"\\u5305\\u88C5\\u5668\"), \"\\u4E2D\\uFF0C\\u8BE5\\u5305\\u88C5\\u5668\\u53EA\\u5728\\u91CD\\u65B0\\u6C34\\u5408\\u540E\\u6E32\\u67D3\\u3002\\u6280\\u672F\\u4E0A\\u53EF\\u80FD\\u6709\\u5176\\u4ED6\\u89E3\\u51B3\\u65B9\\u6848\\uFF0C\\u4F46\\u662F\\u9700\\u8981\\u5728\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"initialValue\"), \"\\u5207\\u6362\\u5230\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"storedValue\"), \"\\u65F6\\u77ED\\u6682\\u7684\\\"\\u95EA\\u70C1\\\"\\uFF0C\\u8FD9\\u53EF\\u80FD\\u4F1A\\u5BFC\\u81F4\\u4E0D\\u6109\\u5FEB\\u7684\\u7528\\u6237\\u4F53\\u9A8C\\uFF0C\\u56E0\\u6B64\\u5EFA\\u8BAE\\u4F7F\\u7528\\u6B64\\u89E3\\u51B3\\u65B9\\u6848\\u3002\"), mdx(\"h3\", null, \"\\u4ECE\\u5B58\\u50A8\\u4E2D\\u5220\\u9664\\u9879\\u76EE {#deleting-an-item-from-storage}\"), mdx(\"p\", null, \"\\u5BF9\\u4E8E\\u60A8\\u60F3\\u4ECE\\u5B58\\u50A8\\u4E2D\\u5220\\u9664\\u9879\\u76EE\\u7684\\u60C5\\u51B5\\uFF0C\\n\\u4F7F\\u7528\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"atomWithStorage\"), \"\\u521B\\u5EFA\\u7684\\u539F\\u5B50\\u5728\\u5199\\u5165\\u65F6\\u63A5\\u53D7\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"RESET\"), \"\\u7B26\\u53F7\\u3002\"), mdx(\"p\", null, \"\\u53C2\\u89C1\\u4EE5\\u4E0B\\u793A\\u4F8B\\u4EE5\\u4E86\\u89E3\\u4F7F\\u7528\\u65B9\\u6CD5\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-jsx\"\n  }, \"import { useAtom } from 'jotai'\\nimport { atomWithStorage, RESET } from 'jotai/utils'\\n\\nconst textAtom = atomWithStorage('text', 'hello')\\n\\nconst TextBox = () => {\\n  const [text, setText] = useAtom(textAtom)\\n\\n  return (\\n    <>\\n      <input value={text} onChange={(e) => setText(e.target.value)} />\\n      <button onClick={() => setText(RESET)}>Reset (to 'hello')</button>\\n    </>\\n  )\\n}\\n\")), mdx(\"p\", null, \"\\u5982\\u679C\\u9700\\u8981\\uFF0C\\u60A8\\u8FD8\\u53EF\\u4EE5\\u6839\\u636E\\u5148\\u524D\\u7684\\u503C\\u8FDB\\u884C\\u6761\\u4EF6\\u91CD\\u7F6E\\u3002\"), mdx(\"p\", null, \"\\u5982\\u679C\\u60A8\\u5E0C\\u671B\\u5728\\u5148\\u524D\\u7684\\u503C\\u6EE1\\u8DB3\\u67D0\\u4E2A\\u6761\\u4EF6\\u65F6\\u6E05\\u9664localStorage\\u4E2D\\u7684\\u952E\\uFF0C\\u8FD9\\u53EF\\u80FD\\u7279\\u522B\\u6709\\u7528\\u3002\"), mdx(\"p\", null, \"\\u4EE5\\u4E0B\\u793A\\u4F8B\\u8BF4\\u660E\\u4E86\\u8FD9\\u79CD\\u7528\\u6CD5\\uFF0C\\u5373\\u6BCF\\u5F53\\u5148\\u524D\\u7684\\u503C\\u4E3A\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"true\"), \"\\u65F6\\uFF0C\\u6E05\\u9664\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"visible\"), \"\\u952E\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-jsx\"\n  }, \"import { useAtom } from 'jotai'\\nimport { atomWithStorage, RESET } from 'jotai/utils'\\n\\nconst isVisibleAtom = atomWithStorage('visible', false)\\n\\nconst TextBox = () => {\\n  const [isVisible, setIsVisible] = useAtom(isVisibleAtom)\\n\\n  return (\\n    <>\\n      { isVisible && <h1>Header is visible!</h1> }\\n      <button onClick={() => setIsVisible((prev) => prev ? RESET : true))}>Toggle visible</button>\\n    </>\\n  )\\n}\\n\")), mdx(\"h3\", null, \"React-Native \\u5B9E\\u73B0 {#react-native-implementation}\"), mdx(\"p\", null, \"\\u4F60\\u53EF\\u4EE5\\u4F7F\\u7528\\u4EFB\\u4F55\\u5B9E\\u73B0\\u4E86 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getItem\"), \"\\u3001\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"setItem\"), \" \\u548C \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"removeItem\"), \" \\u7684\\u5E93\\u3002\\n\\u5047\\u8BBE\\u4F60\\u4F1A\\u4F7F\\u7528\\u793E\\u533A\\u63D0\\u4F9B\\u7684\\u6807\\u51C6 AsyncStorage\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"import { atomWithStorage, createJSONStorage } from 'jotai/utils'\\nimport AsyncStorage from '@react-native-async-storage/async-storage'\\n\\nconst storage = createJSONStorage(() => AsyncStorage)\\nconst content = {} // \\u4EFB\\u4F55\\u53EF\\u4EE5 JSON \\u5E8F\\u5217\\u5316\\u7684\\u5185\\u5BB9\\nconst storedAtom = atomWithStorage('stored-key', content, storage)\\n\")), mdx(\"h4\", null, \"\\u4F7F\\u7528 AsyncStorage \\u7684\\u6CE8\\u610F\\u4E8B\\u9879\\uFF08\\u81EA v2.2.0 \\u8D77\\uFF09 {#notes-with-asyncstorage-(since-v2.2.0)}\"), mdx(\"p\", null, \"\\u5982\\u679C\\u4F60\\u4F7F\\u7528\\u4EFB\\u4F55\\u7C7B\\u578B\\u7684 AsyncStorage\\uFF0C\\u539F\\u5B50\\u503C\\u53EF\\u80FD\\u4F1A\\u53D8\\u4E3A\\u5F02\\u6B65\\u3002\\u56E0\\u6B64\\uFF0C\\u5982\\u679C\\u4F60\\u8981\\u66F4\\u65B0\\u503C\\uFF0C\\u4F60\\u53EF\\u80FD\\u9700\\u8981\\u89E3\\u6790 promise\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"const countAtom = atomWithStorage('count-key', 0, anyAsyncStorage)\\nconst Component = () => {\\n  const [count, setCount] = useAtom(countAtom)\\n  const increment = () => {\\n    setCount(async (promiseOrValue) => (await promiseOrValue) + 1)\\n  }\\n  // ...\\n}\\n\")), mdx(\"h3\", null, \"\\u9A8C\\u8BC1\\u5B58\\u50A8\\u7684\\u503C {#validating-stored-values}\"), mdx(\"p\", null, \"\\u8981\\u4E3A\\u4F60\\u7684\\u5B58\\u50A8\\u539F\\u5B50\\u6DFB\\u52A0\\u8FD0\\u884C\\u65F6\\u9A8C\\u8BC1\\uFF0C\\u4F60\\u9700\\u8981\\u521B\\u5EFA\\u4E00\\u4E2A\\u81EA\\u5B9A\\u4E49\\u7684\\u5B58\\u50A8\\u5B9E\\u73B0\\u3002\"), mdx(\"p\", null, \"\\u4E0B\\u9762\\u662F\\u4E00\\u4E2A\\u4F8B\\u5B50\\uFF0C\\u5B83\\u4F7F\\u7528 Zod \\u6765\\u9A8C\\u8BC1\\u5B58\\u50A8\\u5728 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"localStorage\"), \" \\u4E2D\\u7684\\u503C\\uFF0C\\u5E76\\u8FDB\\u884C\\u8DE8\\u6807\\u7B7E\\u540C\\u6B65\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"import { atomWithStorage } from 'jotai/utils'\\nimport { z } from 'zod'\\n\\nconst myNumberSchema = z.number().int().nonnegative()\\n\\nconst storedNumberAtom = atomWithStorage('my-number', 0, {\\n  getItem(key, initialValue) {\\n    const storedValue = localStorage.getItem(key)\\n    try {\\n      return myNumberSchema.parse(JSON.parse(storedValue ?? ''))\\n    } catch {\\n      return initialValue\\n    }\\n  },\\n  setItem(key, value) {\\n    localStorage.setItem(key, JSON.stringify(value))\\n  },\\n  removeItem(key) {\\n    localStorage.removeItem(key)\\n  },\\n  subscribe(key, callback, initialValue) {\\n    if (\\n      typeof window === 'undefined' ||\\n      typeof window.addEventListener === 'undefined'\\n    ) {\\n      return\\n    }\\n    window.addEventListener('storage', (e) => {\\n      if (e.storageArea === localStorage && e.key === key) {\\n        let newValue\\n        try {\\n          newValue = myNumberSchema.parse(JSON.parse(e.newValue ?? ''))\\n        } catch {\\n          newValue = initialValue\\n        }\\n        callback(newValue)\\n      }\\n    })\\n  },\\n})\\n\")), mdx(\"p\", null, \"\\u6211\\u4EEC\\u8FD8\\u6709\\u4E00\\u4E2A\\u65B0\\u7684\\u5DE5\\u5177 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"unstable_withStorageValidator\"), \" \\u6765\\u7B80\\u5316\\u4E00\\u4E9B\\u60C5\\u51B5\\u3002\\n\\u4E0A\\u8FF0\\u60C5\\u51B5\\u5C06\\u53D8\\u4E3A\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"import {\\n  atomWithStorage,\\n  createJSONStorage,\\n  unstable_withStorageValidator as withStorageValidator,\\n} from 'jotai/utils'\\nimport { z } from 'zod'\\n\\nconst myNumberSchema = z.number().int().nonnegative()\\nconst isMyNumber = (v) => myNumberSchema.safeParse(v).success);\\n\\nconst storedNumberAtom = atomWithStorage(\\n  'my-number',\\n  0,\\n  withStorageValidator(isMyNumber)(createJSONStorage()),\\n)\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"92c16388-8862-5fc9-9e28-4ec13afa0c9d","slug":"utilities/storage","__params":{"slug":"utilities"}}},"staticQueryHashes":["171421096","930225796"]}