{"componentChunkName":"component---src-pages-docs-mdx-slug-js","path":"/docs/utilities/async","result":{"data":{"mdx":{"slug":"utilities/async","frontmatter":{"title":"Async","description":null},"body":"const _excluded = [\"components\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nconst _frontmatter = {\n  \"title\": \"Async\",\n  \"nav\": 3.03,\n  \"keywords\": \"load,loadable,observable\"\n};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return mdx(\"div\", props);\n};\nconst CodeSandbox = makeShortcode(\"CodeSandbox\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  let {\n      components\n    } = _ref,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"\\u6240\\u6709\\u7684\\u539F\\u5B50\\u90FD\\u652F\\u6301\\u5F02\\u6B65\\u884C\\u4E3A\\uFF0C\\u5982\\u5F02\\u6B65\\u8BFB\\u53D6\\u6216\\u5F02\\u6B65\\u5199\\u5165\\u3002\\u7136\\u800C\\uFF0C\\u8FD9\\u91CC\\u63CF\\u8FF0\\u7684API\\u53EF\\u4EE5\\u63D0\\u4F9B\\u66F4\\u591A\\u7684\\u63A7\\u5236\\u3002\"), mdx(\"h2\", null, \"loadable {#loadable}\"), mdx(\"p\", null, \"\\u5982\\u679C\\u4F60\\u4E0D\\u5E0C\\u671B\\u5F02\\u6B65\\u539F\\u5B50\\u6302\\u8D77\\u6216\\u629B\\u51FA\\u5230\\u9519\\u8BEF\\u8FB9\\u754C\\uFF08\\u4F8B\\u5982\\uFF0C\\u4E3A\\u4E86\\u66F4\\u7EC6\\u7C92\\u5EA6\\u7684\\u52A0\\u8F7D\\u548C\\u9519\\u8BEF\\u903B\\u8F91\\u63A7\\u5236\\uFF09\\uFF0C\\u4F60\\u53EF\\u4EE5\\u4F7F\\u7528 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"loadable\"), \" \\u5DE5\\u5177\\u3002\"), mdx(\"p\", null, \"\\u5B83\\u5BF9\\u4EFB\\u4F55\\u539F\\u5B50\\u90FD\\u80FD\\u8D77\\u4F5C\\u7528\\u3002\\u53EA\\u9700\\u7528 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"loadable\"), \" \\u5DE5\\u5177\\u5305\\u88C5\\u4F60\\u7684\\u539F\\u5B50\\u3002\\u5B83\\u8FD4\\u56DE\\u4E00\\u4E2A\\u5177\\u6709\\u4E09\\u79CD\\u72B6\\u6001\\u4E4B\\u4E00\\u7684\\u503C\\uFF1A\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"loading\"), \"\\uFF0C\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"hasData\"), \" \\u548C \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"hasError\"), \"\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-ts\"\n  }, \"{\\n    state: 'loading' | 'hasData' | 'hasError',\\n    data?: any,\\n    error?: any,\\n}\\n\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-jsx\"\n  }, \"import { loadable } from \\\"jotai/utils\\\"\\n\\nconst asyncAtom = atom(async (get) => ...)\\nconst loadableAtom = loadable(asyncAtom)\\n// \\u4E0D\\u9700\\u8981\\u88AB <Suspense> \\u5143\\u7D20\\u5305\\u88F9\\nconst Component = () => {\\n  const [value] = useAtom(loadableAtom)\\n  if (value.state === 'hasError') return <Text>{value.error}</Text>\\n  if (value.state === 'loading') {\\n    return <Text>Loading...</Text>\\n  }\\n  console.log(value.data) // Promise\\u7684\\u7ED3\\u679C\\n  return <Text>Value: {value.data}</Text>\\n}\\n\")), mdx(\"h2\", null, \"atomWithObservable {#atomwithobservable}\"), mdx(\"p\", null, \"\\u53C2\\u8003\\uFF1A\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/pmndrs/jotai/pull/341\"\n  }, \"https://github.com/pmndrs/jotai/pull/341\")), mdx(\"h3\", null, \"\\u4F7F\\u7528\\u65B9\\u6CD5 {#usage}\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-jsx\"\n  }, \"import { useAtom } from 'jotai'\\nimport { atomWithObservable } from 'jotai/utils'\\nimport { interval } from 'rxjs'\\nimport { map } from 'rxjs/operators'\\n\\nconst counterSubject = interval(1000).pipe(map((i) => `#${i}`))\\nconst counterAtom = atomWithObservable(() => counterSubject)\\n\\nconst Counter = () => {\\n  const [counter] = useAtom(counterAtom)\\n  return <div>count: {counter}</div>\\n}\\n\")), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"atomWithObservable\"), \" \\u51FD\\u6570\\u4ECE rxjs\\uFF08\\u6216\\u7C7B\\u4F3C\\uFF09\\u7684 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"subject\"), \" \\u6216 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"observable\"), \" \\u521B\\u5EFA\\u4E00\\u4E2A\\u539F\\u5B50\\u3002\\n\\u5176\\u503C\\u5C06\\u662F\\u6D41\\u4E2D\\u6700\\u540E\\u53D1\\u51FA\\u7684\\u503C\\u3002\"), mdx(\"p\", null, \"\\u8981\\u4F7F\\u7528\\u8FD9\\u4E2A\\u539F\\u5B50\\uFF0C\\u4F60\\u9700\\u8981\\u7528 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"<Suspense>\"), \" \\u5305\\u88F9\\u4F60\\u7684\\u7EC4\\u4EF6\\u3002\\u67E5\\u770B \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"../guides/async.mdx\"\n  }, \"guides/async\"), \"\\u3002\"), mdx(\"h3\", null, \"\\u521D\\u59CB\\u503C {#initial-value}\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"atomWithObservable\"), \" \\u63A5\\u53D7\\u7B2C\\u4E8C\\u4E2A\\u53EF\\u9009\\u53C2\\u6570 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"{ initialValue }\"), \"\\uFF0C\\u8BE5\\u53C2\\u6570\\u5141\\u8BB8\\u4E3A\\u539F\\u5B50\\u6307\\u5B9A\\u521D\\u59CB\\u503C\\u3002\\u5982\\u679C\\u63D0\\u4F9B\\u4E86 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"initialValue\"), \"\\uFF0C\\u90A3\\u4E48 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"atomWithObservable\"), \" \\u5C06\\u4E0D\\u4F1A\\u6302\\u8D77\\uFF0C\\u5E76\\u4E14\\u5728\\u4ECE observable \\u63A5\\u6536\\u5230\\u7B2C\\u4E00\\u4E2A\\u503C\\u4E4B\\u524D\\u663E\\u793A\\u521D\\u59CB\\u503C\\u3002\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"initialValue\"), \" \\u53EF\\u4EE5\\u662F\\u4E00\\u4E2A\\u503C\\uFF0C\\u4E5F\\u53EF\\u4EE5\\u662F\\u4E00\\u4E2A\\u8FD4\\u56DE\\u503C\\u7684\\u51FD\\u6570\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"const counterAtom = atomWithObservable(() => counterSubject, {\\n  initialValue: 10,\\n})\\n\\nconst counterAtom2 = atomWithObservable(() => counterSubject, {\\n  initialValue: () => Math.random(),\\n})\\n\")), mdx(\"h3\", null, \"Codesandbox {#codesandbox}\"), mdx(CodeSandbox, {\n    id: \"88pnt\",\n    mdxType: \"CodeSandbox\"\n  }), mdx(\"h2\", null, \"unwrap {#unwrap}\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"unwrap\"), \" \\u5DE5\\u5177\\u5C06\\u628A\\u4E00\\u4E2A\\u5F02\\u6B65\\u539F\\u5B50\\u8F6C\\u6362\\u4E3A\\u4E00\\u4E2A\\u540C\\u6B65\\u539F\\u5B50\\uFF0C\\u5C31\\u50CF \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"loadable\"), \" \\u4E00\\u6837\\u3002\\n\\u4E0E \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"loadable\"), \" \\u4E0D\\u540C\\uFF0C\\u53EF\\u4EE5\\u914D\\u7F6E\\u56DE\\u9000\\u503C\\u3002\\n\\u4E0E \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"loadable\"), \" \\u4E0D\\u540C\\uFF0C\\u9519\\u8BEF\\u4E0D\\u4F1A\\u88AB\\u5904\\u7406\\uFF0C\\u800C\\u662F\\u76F4\\u63A5\\u629B\\u51FA\\u3002\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"unwrap\"), \" \\u7684\\u4F7F\\u7528\\u573A\\u666F\\u662F\\u4E3A\\u4E86\\u7B80\\u5316\\u6D3E\\u751F\\u539F\\u5B50\\u3002\\n\\u8FD9\\u5BF9\\u4E8E v2 API \\u7279\\u522B\\u6709\\u7528\\uFF0C\\n\\u56E0\\u4E3A\\u5728\\u8BFB\\u53D6\\u51FD\\u6570\\u4E2D\\u7684 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"get\"), \" \\u4E0D\\u89E3\\u6790 promise\\u3002\"), mdx(\"h3\", null, \"\\u7B7E\\u540D {#signature}\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-ts\"\n  }, \"function unwrap<Value, Args extends unknown[], Result>(\\n  anAtom: WritableAtom<Value, Args, Result>,\\n): WritableAtom<Awaited<Value> | undefined, Args, Result>\\n\\nfunction unwrap<Value, Args extends unknown[], Result, PendingValue>(\\n  anAtom: WritableAtom<Value, Args, Result>,\\n  fallback: (prev?: Awaited<Value>) => PendingValue,\\n): WritableAtom<Awaited<Value> | PendingValue, Args, Result>\\n\\nfunction unwrap<Value>(anAtom: Atom<Value>): Atom<Awaited<Value> | undefined>\\n\\nfunction unwrap<Value, PendingValue>(\\n  anAtom: Atom<Value>,\\n  fallback: (prev?: Awaited<Value>) => PendingValue,\\n): Atom<Awaited<Value> | PendingValue>\\n\")), mdx(\"h3\", null, \"\\u4F7F\\u7528\\u65B9\\u6CD5 {#usage}\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-tsx\"\n  }, \"import { atom } from 'jotai'\\nimport { unwrap } from 'jotai/utils'\\n\\nconst countAtom = atom(0)\\nconst delayedCountAtom = atom(async (get) => {\\n  await new Promise((r) => setTimeout(r, 500))\\n  return get(countAtom)\\n})\\n\\nconst unwrapped1Atom = unwrap(delayedCountAtom)\\n// \\u5F53\\u6302\\u8D77\\u65F6\\uFF0C\\u503C\\u4E3A `undefined`\\n\\nconst unwrapped2Atom = unwrap(delayedCountAtom, (prev) => prev ?? 0)\\n// \\u521D\\u59CB\\u503C\\u4E3A `0`\\uFF0C\\u540E\\u7EED\\u66F4\\u65B0\\u4FDD\\u6301\\u524D\\u4E00\\u4E2A\\u503C\\u3002\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"ad0f5e83-c680-546d-97c9-b9b36c774159","slug":"utilities/async","__params":{"slug":"utilities"}}},"staticQueryHashes":["171421096","930225796"]}